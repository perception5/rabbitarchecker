<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rabbitars Wallet Checker</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    input, button { padding: 8px; margin: 6px 0; width: 100%; }
    .nft { margin: 12px 0; padding: 10px; border: 1px solid #ccc; }
    img { max-width: 150px; display: block; cursor: pointer; }
    pre { background: #f4f4f4; padding: 10px; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>Playboy Rabbitars Wallet Checker</h1>
  <p>Paste an Ethereum wallet address to check ownership.</p>
  <input id="wallet" placeholder="0x...">
  <button onclick="checkNFTs()">Check Wallet</button>
  <div id="results"></div>
  <pre id="debug"></pre>

  <script>
    const API_KEY = "BWgsxPuacgw5Tvb8VClPY"; // Replace with your key
    const CONTRACT = "0x65c234d041f9ef96e2f126263727dfa582206d82"; // Playboy Rabbitars contract

    async function checkNFTs(pageKey) {
      const wallet = document.getElementById("wallet").value.trim();
      const results = document.getElementById("results");
      const debug = document.getElementById("debug");

      if (!wallet) {
        results.innerHTML = "Please enter a wallet address.";
        return;
      }

      results.innerHTML = "Checking...";
      debug.textContent = "";

      try {
        let url = `https://eth-mainnet.g.alchemy.com/nft/v2/${API_KEY}/getNFTs?owner=${wallet}&contractAddresses[]=${CONTRACT}&withMetadata=true`;
        if (pageKey) url += `&pageKey=${pageKey}`;

        const res = await fetch(url);
        const data = await res.json();
        debug.textContent = JSON.stringify(data, null, 2);

        if (data.ownedNfts && data.ownedNfts.length > 0) {
          results.innerHTML = `<h2>Rabbitars Found!</h2>`;
          data.ownedNfts.forEach(nft => {
            const tokenId = parseInt(nft.id.tokenId, 16);
            const div = document.createElement("div");
            div.className = "nft";

            // Build openSeaLink deep link
            const openSeaLink = `https://opensea.io/assets/ethereum/${CONTRACT}/${tokenId}`;

            div.innerHTML = `
              <p>Token ID: ${tokenId}</p>
              ${nft.media && nft.media[0] && nft.media[0].gateway ? `<a href="${openSeaLink}" target="_blank"><img src="${nft.media[0].gateway}" alt="NFT image"></a>` : ""}
            `;
            results.appendChild(div);
          });

          // Pagination button
          if (data.pageKey) {
            const nextBtn = document.createElement("button");
            nextBtn.textContent = "Load More";
            nextBtn.onclick = () => checkNFTs(data.pageKey);
            results.appendChild(nextBtn);
          }

        } else {
          results.innerHTML = "No Rabbitars owned.";
        }
      } catch (err) {
        results.innerHTML = "Error: " + err;
        console.error(err);
      }
    }
  </script>
</body>
</html>
